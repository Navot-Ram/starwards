# starwards

This game's client is designed to run in a chrome browser.

## Developer instructions

This project is not written using TDD. For now, most of the testing has to be made by hand. so make sure you are familiar with the areas that are affected by changes you make in the code.

### Project structure

The project is a monorepo, based on [yarn workspaces](https://classic.yarnpkg.com/en/docs/workspaces/) and [lerna](https://lerna.js.org/). The sub-modules are in the `modules` folder:

-   browser - the frontend client for the game
-   model - the game model objects, used by both client and server
-   server - The game's server

Utility scripts are stored in the `scripts` folder:

-   `pkg.js` packages and compiles the game server into a single, native executable. used by `yarn pkg` command.
-   `pre-commit.js` rens before each commit, notmalizes text formatting and re-generates some boilerplate configurations. runs in pre-commit hook.

### IDE

This project is written with [VSCode](https://code.visualstudio.com/) in mind. specifically configured for these extensions: [esbenp.prettier-vscode](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode), [ms-vscode.vscode-typescript-tslint-plugin](https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-typescript-tslint-plugin), [msjsdiag.debugger-for-chrome](https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome), [fabiospampinato.vscode-commands
](https://marketplace.visualstudio.com/items?itemName=fabiospampinato.vscode-commands) and [jvandyke.vscode-circleci
](https://marketplace.visualstudio.com/items?itemName=jvandyke.vscode-circleci).

I also reccommend these plugins for best productivity: [vscode-icons-team.vscode-icons](https://marketplace.visualstudio.com/items?itemName=vscode-icons-team.vscode-icons), [gamunu.vscode-yarn](https://marketplace.visualstudio.com/items?itemName=gamunu.vscode-yarn), [alefragnani.numbered-bookmarks](https://marketplace.visualstudio.com/items?itemName=alefragnani.numbered-bookmarks), [eamodio.gitlens](https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens), [coenraads.bracket-pair-colorizer](https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer).

Notice that vscode launch configurations (in `.vscode/launch.json`) are generated by the `pre-commit.js` script, so don't change them directly, but rather make changes to the script.

### Installing workspace and running commands

to install a development environment, you need to have [node.js](https://nodejs.org/en/download/), (yarn)[https://yarnpkg.com/getting-started/install] and [git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git) installd.
Then, `git clone` this repo locally and run:

```
$ yarn install
$ yarn build
```

you've just installed the development environment, and have succesfully built the code needed to run the server. Notice how the `build` command propagated to each sub-module? That means that each sub-module has similar commands that correspond to the root project's lifecycle:

-   `yarn test` Execute all tests. currently there are very few of them left.
-   `yarn clean` Cleans artifacts created by previous `build` commands
-   `yarn build` Builds the library. the result artifacts will be in the `dist` or `cjs` folder inside the module.
-   `yarn lint` Checks that all the code is formatted correctly. this minimizes cases where changes to indentation and spaces add clutter to the project.
-   `yarn prettify` Normalizes code formatting styles.

## running and debugging a local development server

The `run server` command (in `.vscode/launch.json`) runs a local development server. This server will automatically re-load the client appilcation when changes are made to it, but you will need to restart the server manually if you want it to re-load server-side code (changes to the `server` or `model` modules). after the server is up, open your chrome browser at `http://localhost:8080/`.

To quickly host a local game with a remote party, I reccommend you use [ngrok](https://ngrok.com/). just download the executable file to the root of this project and run `./ngrok http 8080` to create an HTTP tunnel to your local server.

### Building executable

At some early point this game was supposed to be served as an execuutable. The build process remained. you can buyild native executable files for the server by runniing `yarn pkg`
